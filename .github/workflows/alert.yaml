name: GitHub Alert Workflow

on:
    push:
        branches:
        - main
        - alert
    workflow_dispatch:
    

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Build
              run: |
                echo "build..." && exit 1 # Error example

    notify:
        needs: [build]
        if: failure() # <-- Runs only if the 'build' job fails
        runs-on: ubuntu-latest
        steps:
            - name: Placeholder notification
              run: |
                echo "This is where the Slack/email alert will go."
                curl -X POST -H 'Content-type: application/json' \
                --data "{
                    \"text\": \"ðŸš¨ GitHub Alert Workflow\\n   - Repo: $GITHUB_REPOSITORY,\\n   - Workflow: $GITHUB_WORKFLOW,\\n   - Job: $GITHUB_JOB,\\n   - Run: $GITHUB_RUN_NUMBER\"
                }" \
                ${{ secrets.ALERT_SLACK_WEBHOOK_URL }}
